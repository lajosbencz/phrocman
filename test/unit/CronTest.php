<?php

use Phrocman\Cron;
use PHPUnit\Framework\TestCase;

class CronTest extends TestCase
{
    public function provideChecks()
    {
        return [
            ['*', '*', '*', '*', '*', '1/10', '2019-06-06 08:00:00', false],
            ['*', '*', '*', '*', '*', '1/10', '2019-06-06 08:00:01', true],
            ['*', '*', '*', '*', '*', '1/10', '2019-06-06 08:00:02', false],
            ['*', '*', '*', '*', '*', '1/10', '2019-06-06 08:00:11', true],
            ['*', '*', '*', '*', '*', '1/10', '2019-06-06 08:00:21', true],
            ['*', '*', '*', '*', '*', '1/10', '2019-06-06 08:00:31', true],
            ['*', '*', '*', '*', '*', '1/10', '2019-06-06 08:00:41', true],
            ['*', '*', '*', '*', '*', '1/10', '2019-06-06 08:00:51', true],

            ['*', '*', '*', '*', '0', '0', '2019-06-06 07:59:59', false],
            ['*', '*', '*', '*', '0', '0', '2019-06-06 08:00:00', true],
            ['*', '*', '*', '*', '0', '0', '2019-06-06 08:00:01', false],
            ['*', '*', '*', '*', '0', '0', '2019-06-06 08:01:00', false],
            ['*', '*', '*', '*', '0/15', '0', '2019-06-06 08:14:00', false],
            ['*', '*', '*', '*', '0/15', '0', '2019-06-06 08:15:00', true],
            ['*', '*', '*', '*', '0/15', '0', '2019-06-06 08:16:00', false],
            ['*', '*', '*', '*', '5,15,25', '0', '2019-06-06 08:14:00', false],
            ['*', '*', '*', '*', '5,15,25', '0', '2019-06-06 08:15:00', true],
            ['*', '*', '*', '*', '5,15,25', '0', '2019-06-06 08:15:01', false],
            ['*', '*', '*', '*', '5,15,25', '0', '2019-06-06 08:16:00', false],
        ];
    }

    /**
     * @dataProvider provideChecks
     * @param $wd
     * @param $m
     * @param $d
     * @param $h
     * @param $i
     * @param $s
     * @param $now
     * @param $ok
     * @throws \Throwable
     */
    public function testCheck($wd, $m, $d, $h, $i, $s, $now, $ok)
    {
        $dt = new DateTime($now);
        $c = new Cron($wd, $m, $d, $h, $i, $s);
        $this->assertEquals($ok, $c->check($dt));
    }
}
